
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tutorial avanzado para aprender a programar en lenguaje R">
      
      
      
        <meta name="author" content="José Carlos y Manuel Jesús">
      
      
      <link rel="shortcut icon" href="../icon/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.0">
    
    
      
        <title>Modelar datos - Tutorial avanzado de programación en R</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a3f8f96a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=:300,400,400i,700%7CConsolas&display=fallback">
        <style>:root{--md-text-font-family:"";--md-code-font-family:"Consolas"}</style>
      
    
    
    
      <link rel="stylesheet" href="../extra.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-VCVDM3VLCC","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="indigo">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduccion" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href=".." title="Tutorial avanzado de programación en R" class="md-header__button md-logo" aria-label="Tutorial avanzado de programación en R">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 2h2v2c0 1.44.68 2.61 1.88 3.78.86.83 2.01 1.63 3.21 2.42l-1.83 1.19C8.27 10.72 7.31 10 6.5 9.21 5.07 7.82 4 6.1 4 4V2m14 0h2v2c0 2.1-1.07 3.82-2.5 5.21-1.41 1.38-3.21 2.52-4.96 3.63-1.75 1.12-3.45 2.21-4.66 3.38C6.68 17.39 6 18.56 6 20v2H4v-2c0-2.1 1.07-3.82 2.5-5.21 1.41-1.38 3.21-2.52 4.96-3.63 1.75-1.12 3.45-2.21 4.66-3.38C17.32 6.61 18 5.44 18 4V2m-3.26 10.61c.99.67 1.95 1.39 2.76 2.18C18.93 16.18 20 17.9 20 20v2h-2v-2c0-1.44-.68-2.61-1.88-3.78-.86-.83-2.01-1.63-3.21-2.42l1.83-1.19M7 3h10v1l-.06.5H7.06L7 4V3m.68 3h8.64c-.24.34-.52.69-.9 1.06l-.51.44H9.07l-.49-.44c-.38-.37-.66-.72-.9-1.06m1.41 10.5h5.84l.49.44c.38.37.66.72.9 1.06H7.68c.24-.34.52-.69.9-1.06l.51-.44m-2.03 3h9.88l.06.5v1H7v-1l.06-.5z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Tutorial avanzado de programación en R
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Modelar datos
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Limpiar" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Tutorial avanzado de programación en R" class="md-nav__button md-logo" aria-label="Tutorial avanzado de programación en R">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 2h2v2c0 1.44.68 2.61 1.88 3.78.86.83 2.01 1.63 3.21 2.42l-1.83 1.19C8.27 10.72 7.31 10 6.5 9.21 5.07 7.82 4 6.1 4 4V2m14 0h2v2c0 2.1-1.07 3.82-2.5 5.21-1.41 1.38-3.21 2.52-4.96 3.63-1.75 1.12-3.45 2.21-4.66 3.38C6.68 17.39 6 18.56 6 20v2H4v-2c0-2.1 1.07-3.82 2.5-5.21 1.41-1.38 3.21-2.52 4.96-3.63 1.75-1.12 3.45-2.21 4.66-3.38C17.32 6.61 18 5.44 18 4V2m-3.26 10.61c.99.67 1.95 1.39 2.76 2.18C18.93 16.18 20 17.9 20 20v2h-2v-2c0-1.44-.68-2.61-1.88-3.78-.86-.83-2.01-1.63-3.21-2.42l1.83-1.19M7 3h10v1l-.06.5H7.06L7 4V3m.68 3h8.64c-.24.34-.52.69-.9 1.06l-.51.44H9.07l-.49-.44c-.38-.37-.66-.72-.9-1.06m1.41 10.5h5.84l.49.44c.38.37.66.72.9 1.06H7.68c.24-.34.52-.69.9-1.06l.51-.44m-2.03 3h9.88l.06.5v1H7v-1l.06-.5z"/></svg>

    </a>
    Tutorial avanzado de programación en R
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tidyverse/" class="md-nav__link">
        Tidyverse
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../visualizar/" class="md-nav__link">
        Visualizar datos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../importar/" class="md-nav__link">
        Importar datos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ordenar/" class="md-nav__link">
        Ordenar datos
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Modelar datos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Modelar datos
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    Introducción
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelado-basico" class="md-nav__link">
    Modelado básico
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelado-de-regresion-lineal" class="md-nav__link">
    Modelado de regresión lineal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#otros-modelados" class="md-nav__link">
    Otros modelados
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicios" class="md-nav__link">
    Ejercicios
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../genesis/" class="md-nav__link">
        Bioconductor y GENESIS
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ejercicios/" class="md-nav__link">
        Realización de ejercicios
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../acerca/" class="md-nav__link">
        Acerca de
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    Introducción
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelado-basico" class="md-nav__link">
    Modelado básico
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelado-de-regresion-lineal" class="md-nav__link">
    Modelado de regresión lineal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#otros-modelados" class="md-nav__link">
    Otros modelados
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicios" class="md-nav__link">
    Ejercicios
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Modelar datos</h1>
                
                <h2 id="introduccion">Introducción</h2>
<p>Modelar consiste en la aplicación de herramientas matemáticas para caracterizar un conjunto de datos y encontrar relaciones entre ellos, con las que somos capaces de:</p>
<ul>
<li>Predecir futuros resultados</li>
<li>Encontrar patrones y diferencias entre variables</li>
<li>Mejorar la visualización de los resultados</li>
</ul>
<p>A la hora de modelar, existen dos partes a seguir:</p>
<ul>
<li>
<p>Primero, debemos encontrar un patrón dentro de los datos, que puede ser desde una relación lineal simple (<em>y</em> = a·<em>x</em> + b) hasta una curva cuadrática (<em>y</em> = a·<em>x</em>^b), siendo <em>x</em> e <em>y</em> las variables conocidas y "a" y "b" los parámetros que podemos modificar para encontrar la relación.</p>
</li>
<li>
<p>Tras esto, conociendo el patrón, debemos encontrar el modelo que se ajusta a los datos (es decir, definir "a" y "b")</p>
</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Nota</p>
<p>Hay que tener en cuenta que <em>ningún modelo elegido es perfecto</em>, simplemente es el que mejor se ajusta a los datos. Hay veces en el que el mejor modelo simplemente es malo y no tiene el por qué cumplirse en todos los casos.</p>
</div>
<p>En esta parte del tutorial, además de <em>tidyverse</em>, emplearemos el paquete <em>modelr</em>, incluido en R base y que nos dará algunas herramientas para comenzar a modelar. Además, vamos a usar <em>modeldata</em>, que incluye una serie de conjuntos de datos preparados para aprender a modelar. Instalamos los paquetes y los cargamos:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;modeldata&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">modelr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">modeldata</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

<h2 id="modelado-basico">Modelado básico</h2>
<p>Para este apartado, vamos a usar el conjunto de datos contenido en <em>modeldata</em> llamado "<em>oils</em>", que muestra las diferentes concentraciones de ácidos grasos en diferentes especies vegetales.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">data</span><span class="p">(</span><span class="n">oils</span><span class="p">)</span>
<span class="nf">View</span><span class="p">(</span><span class="n">oils</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

<p><img alt="" src="../images/modelar/1.png" title="" /></p>
<p>Para comenzar a modelar nos puede venir bien representar gráficamente los datos con los que queremos trabajar. Por ejemplo, imaginemos que necesitamos estudiar las concentraciones de ácido oleico con respecto a las de linoleico. Vamos a representar estas variables en un diagrama de dispersión:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">oils</span><span class="p">)</span> <span class="o">+</span> 
    <span class="nf">geom_point</span><span class="p">(</span><span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">linoleic</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">oleic</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>

<p><img alt="" src="../images/modelar/2.png" title="" /></p>
<p>Vemos que hay una clara tendencia lineal entre las variables (<em>y</em> = a·<em>x</em> + b). Para elegir la recta que mejor se ajusta, podemos generar multitud de ellas y elegirla al verla en la gráfica. Para ello, debemos generar rectas "aleatorias", para lo cual podemos usar la función <em>runif</em> para generar pendientes y puntos de corte con el eje y (es decir, "a" y "b" respectivamente)</p>
<p><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">runif</span><span class="p">(</span><span class="o">&lt;</span><span class="n">NÚMERO_DE_RECTAS</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">min</span> <span class="o">=</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
Generamos, por ejemplo, 200 rectas definiendo primero "a" y "b". Viendo la gráfica, podemos deducir el punto de corte con el eje alrededor de 80 (entre 77 y 83) y la pendiente alrededor de 1 (entre -2 y 2):</p>
<p><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">ayb</span> <span class="o">&lt;-</span> <span class="nf">tibble</span><span class="p">(</span>
  <span class="n">a</span> <span class="o">=</span> <span class="nf">runif</span><span class="p">(</span><span class="m">200</span><span class="p">,</span> <span class="m">-2</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span>
  <span class="n">b</span> <span class="o">=</span> <span class="nf">runif</span><span class="p">(</span><span class="m">200</span><span class="p">,</span> <span class="m">77</span><span class="p">,</span> <span class="m">83</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>
Tras lo cual, representamos tanto las variables como las rectas, para lo cual usamos la función de <em>ggplot2</em> llamada <em>geom_abline</em>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">geom_abline</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">DATOS</span><span class="o">&gt;</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">slope</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">PENDIENTE</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">CORTE_EJE_Y</span><span class="o">&gt;</span><span class="p">,))</span>
</code></pre></div>
</td></tr></table>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">ggplot</span><span class="p">()</span> <span class="o">+</span> 
  <span class="nf">geom_abline</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">ayb</span><span class="p">,</span> <span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span><span class="n">slope</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">b</span><span class="p">),</span> <span class="n">alpha</span> <span class="o">=</span> <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">geom_point</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">oils</span><span class="p">,</span> <span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">linoleic</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">oleic</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>

<p>Obtenemos algo parecido a esto:</p>
<p><img alt="" src="../images/modelar/3.png" title="" /></p>
<p>Vemos que la mayoría de líneas generadas están lejos de ajustarse a los datos. Para seleccionar las buenas es necesario calcular la distancia vertical entre los puntos y las líneas, para lo cual es necesario crear funciones.</p>
<p>Este proceso es común a la mayoría de diferentes modelados que podemos hacer sobre un set de datos. Este proceso puede ser tedioso y requiere de bastante experiencia en el tema, tarea a la cual el alumno de bioquímica medio no está acostumbrado. Por ello, en este tutorial proponemos una forma de entrar en el mundo del modelado de datos sin tener que lidiar con programación demasiado compleja.</p>
<h2 id="modelado-de-regresion-lineal">Modelado de regresión lineal</h2>
<p>Un buen punto de partida para comenzar a modelar consiste en crear tus propias regresiones lineales en R. Sin embargo, antes de comenzar siempre es necesario hacer un test de correlación de Pearson sobre nuestros datos. Esto se hace fácilmente empleando la función <code>cor.test()</code>, de la siguiente forma:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">cor.test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

<p>En nuestro caso, determinamos nuestras variables <em>x</em> e <em>y</em> indicando primero "<em>oils</em>" junto con el nombre de la variable empleando el símbolo "<em>$</em>":</p>
<p><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">cor.test</span><span class="p">(</span><span class="n">oils</span><span class="o">$</span><span class="n">oleic</span><span class="p">,</span> <span class="n">oils</span><span class="o">$</span><span class="n">linoleic</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>        <span class="n">Pearson</span><span class="s">&#39;</span><span class="err">s product-moment correlation</span>

<span class="n">data</span><span class="o">:</span>  <span class="n">oils</span><span class="o">$</span><span class="n">oleic</span> <span class="n">and</span> <span class="n">oils</span><span class="o">$</span><span class="n">linoleic</span>
<span class="n">t</span> <span class="o">=</span> <span class="m">-45.185</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="m">94</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">&lt;</span> <span class="m">2.2e-16</span>
<span class="n">alternative</span> <span class="n">hypothesis</span><span class="o">:</span> <span class="n">true</span> <span class="n">correlation</span> <span class="n">is</span> <span class="n">not</span> <span class="n">equal</span> <span class="n">to</span> <span class="m">0</span>
<span class="m">95</span> <span class="n">percent</span> <span class="n">confidence</span> <span class="n">interval</span><span class="o">:</span>
 <span class="m">-0.9851233</span> <span class="m">-0.9667696</span>
<span class="n">sample</span> <span class="n">estimates</span><span class="o">:</span>
       <span class="n">cor</span> 
<span class="m">-0.9777453</span>
</code></pre></div>
</td></tr></table></p>
<p>El coeficiente de correlación cercano al valor <code>-1</code> nos indica que existe una fuerte correlación lineal negativa, y el <em>p</em>-valor menor que <code>0.05</code> señala que el modelo lineal es válido. Ahora podemos plantear un modelo de regresión lineal con seguridad. Para ello, vamos a usar la función <code>lm()</code>. Esta función se usa de forma muy similar a la anterior:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">lm</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">x</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

<p>Definimos una variable para el modelo linear de nuestras variables de la siguiente forma:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">regresion</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">oils</span><span class="o">$</span><span class="n">oleic</span> <span class="o">~</span> <span class="n">oils</span><span class="o">$</span><span class="n">linoleic</span><span class="p">)</span>
<span class="nf">View</span><span class="p">(</span><span class="n">regresion</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

<p><img alt="" src="../images/modelar/4.png" title="" /></p>
<p>Para continuar con el análisis, hacemos un <code>summary()</code> a nuestra nueva variable, obteniendo lo siguiente:</p>
<p><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">summary</span><span class="p">(</span><span class="n">regresion</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">Call</span><span class="o">:</span>
<span class="nf">lm</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">oils</span><span class="o">$</span><span class="n">oleic</span> <span class="o">~</span> <span class="n">oils</span><span class="o">$</span><span class="n">linoleic</span><span class="p">)</span>

<span class="n">Residuals</span><span class="o">:</span>
    <span class="n">Min</span>      <span class="m">1</span><span class="n">Q</span>  <span class="n">Median</span>      <span class="m">3</span><span class="n">Q</span>     <span class="n">Max</span> 
<span class="m">-7.1814</span> <span class="m">-1.6842</span> <span class="m">-0.0709</span>  <span class="m">2.6859</span>  <span class="m">5.0556</span> 

<span class="n">Coefficients</span><span class="o">:</span>
              <span class="n">Estimate</span> <span class="n">Std.</span> <span class="n">Error</span> <span class="n">t</span> <span class="n">value</span> <span class="nf">Pr</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span><span class="p">)</span>    
<span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>   <span class="m">79.35660</span>    <span class="m">0.99614</span>   <span class="m">79.66</span>   <span class="o">&lt;</span><span class="m">2e-16</span> <span class="o">***</span>
<span class="n">oils</span><span class="o">$</span><span class="n">linoleic</span> <span class="m">-0.91699</span>    <span class="m">0.02029</span>  <span class="m">-45.19</span>   <span class="o">&lt;</span><span class="m">2e-16</span> <span class="o">***</span>
<span class="o">---</span>
<span class="n">Signif.</span> <span class="n">codes</span><span class="o">:</span>  <span class="m">0</span> ‘<span class="o">***</span>’ <span class="m">0.001</span> ‘<span class="o">**</span>’ <span class="m">0.01</span> ‘<span class="o">*</span>’ <span class="m">0.05</span> ‘<span class="n">.</span>’ <span class="m">0.1</span> ‘ ’ <span class="m">1</span>

<span class="n">Residual</span> <span class="n">standard</span> <span class="n">error</span><span class="o">:</span> <span class="m">3.133</span> <span class="n">on</span> <span class="m">94</span> <span class="n">degrees</span> <span class="n">of</span> <span class="n">freedom</span>
<span class="n">Multiple</span> <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="o">:</span>  <span class="m">0.956</span><span class="p">,</span> <span class="n">Adjusted</span> <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="o">:</span>  <span class="m">0.9555</span> 
<span class="bp">F</span><span class="o">-</span><span class="n">statistic</span><span class="o">:</span>  <span class="m">2042</span> <span class="n">on</span> <span class="m">1</span> <span class="n">and</span> <span class="m">94</span> <span class="n">DF</span><span class="p">,</span>  <span class="n">p</span><span class="o">-</span><span class="n">value</span><span class="o">:</span> <span class="o">&lt;</span> <span class="m">2.2e-16</span>
</code></pre></div>
</td></tr></table></p>
<p>Vemos como el R<sup>2</sup> obtenido es de <code>0.9555</code>, reafirmando la validez de nuestro modelo lineal. Podemos, finalmente, determinar cuál es la línea de ajuste de este conjunto de datos. Para ello, necesitamos los valores de pendiente y de corte con el eje <em>y</em>. Estos valores ya los hemos calculado al hacer el <code>summary()</code>, y se encuentran en el apartado <code>coefficients</code>:</p>
<p><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">regresion</span><span class="o">$</span><span class="n">coefficients</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>  <span class="p">(</span><span class="n">Intercept</span><span class="p">)</span> <span class="n">oils</span><span class="o">$</span><span class="n">linoleic</span> 
   <span class="m">79.3565958</span>    <span class="m">-0.9169897</span> 
</code></pre></div>
</td></tr></table></p>
<div class="admonition info">
<p class="admonition-title">Nota</p>
<p>Además de para encontrar modelos lineales, <code>lm()</code> sirve para realizar cualquier tipo de regresión, análisis de varianza y covarianza y otros cálculos estadísticos. Puedes profundizar más en cómo usar esta función <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/lm">aquí</a>.</p>
</div>
<p>El valor de <code>(Intercept)</code> es el punto de corte con el eje y <code>oils$linoleic</code> es la pendiente. Sustituyendo estos valores en la ecuación de la recta (<em>y</em> = a·<em>x</em> + b), obtenemos la línea de regresión exacta para nuestros datos. Representándola obtenemos:</p>
<p><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">a</span> <span class="o">&lt;-</span> <span class="n">regresion</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
<span class="n">b</span> <span class="o">&lt;-</span> <span class="n">regresion</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">ggplot</span><span class="p">()</span> <span class="o">+</span> 
  <span class="nf">geom_abline</span><span class="p">(</span><span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span><span class="n">slope</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">b</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">geom_point</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">oils</span><span class="p">,</span> <span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">linoleic</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">oleic</span><span class="p">))</span>
</code></pre></div>
</td></tr></table></p>
<p><img alt="" src="../images/modelar/5.png" title="" /></p>
<div class="admonition example">
<p class="admonition-title">Razona:</p>
<p>Intenta añadir un cuadro de texto en la gráfica que el que se muestre la ecuación de la recta de regresión y el R<sup>2</sup>.</p>
<details class="help"><summary>1ª Pista</summary><p>Prueba a utilizar el comando <code>annotate()</code> tras el resto de comandos <code>geom</code>.</p>
</details>
<details class="help"><summary>2ª Pista</summary><p>Usa el comando <code>annotate()</code> de la siguiente forma:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">annotate</span><span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">POSICIÓN_X</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">POSICIÓN_Y</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;&lt;TEXTO&gt;&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table></p>
</details>
<details class="check"><summary>Respuesta</summary><p><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">ggplot</span><span class="p">()</span> <span class="o">+</span> 
    <span class="nf">geom_abline</span><span class="p">(</span><span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span><span class="n">slope</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">b</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span> <span class="o">+</span>
    <span class="nf">geom_point</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">oils</span><span class="p">,</span> <span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">linoleic</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">oleic</span><span class="p">))</span> <span class="o">+</span>
    <span class="nf">annotate</span><span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span> <span class="m">46</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;y = -0.917x + 79.4&quot;</span><span class="p">,</span> <span class="s">&quot;R2 = 0.9555&quot;</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
    <img alt="" src="../images/modelar/6.png" title="" /></p>
</details>
</div>
<h2 id="otros-modelados">Otros modelados</h2>
<p>Como has podido observar, el modelado de datos, en definitiva, se trata de un proceso estadístico. En este tutorial hemos propuesto como ejemplo básico de modelado la regresión lineal, técnica muy empleada en cualquier rama de la ciencia. Evidentemente, existen muchos más tipos, y pueden enfocarse de maneras ilimitadas. Si sigues interesado en expandir tu conocimientos sobre este tema, te sugerimos que continúes con el apartado de modelado de “<em>R for Data Science</em>”, en concreto con el de <a href="https://r4ds.had.co.nz/model-basics.html#interactions-continuous-and-categorical">interacción entre variables discretas y continuas</a>.</p>
<h2 id="ejercicios">Ejercicios</h2>
<div class="admonition danger">
<p class="admonition-title">Ejercicios de repaso</p>
<p>Para ver si has entendido todo, intenta realizar estos <a href="../datos/tutoradvr_1.0.0.0000.tar.gz" title="">ejercicios propuestos</a>. Para saber cómo hacerlos, visita el <a href="http://127.0.0.1:8000/ejercicios/#como-hacer-los-ejercicios-de-repaso">apartado de "Realización de ejercicios"</a>.
Tras esto, ejecuta el siguiente comando:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">learnr</span><span class="o">::</span><span class="nf">run_tutorial</span><span class="p">(</span><span class="s">&quot;modelar&quot;</span><span class="p">,</span> <span class="s">&quot;tutoradvr&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
Se abrirá una ventana en tu navegador con los ejercicios a resolver</p>
</div>
<div class="admonition cite">
<p class="admonition-title">Referencias</p>
<ul>
<li><a href="https://ucodemy.github.io/rbioq/"><strong><em>Tutorial de programación en R orientado al estudiante de Bioquímica</em></strong>; Ismael Sánchez Pareja</a></li>
<li><a href="https://r4ds.had.co.nz/"><strong><em>R for Data Science</em></strong>; Hadley Wickham, Garrett Grolemund et al.</a></li>
<li><a href="https://www.tmwr.org/index.html"><strong><em>Tidy Modeling with R</em></strong>; Max Kuhn, Julia Silge</a></li>
<li><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/lm"><strong><em>lm function: Fitting Linear Models</em></strong></a></li>
</ul>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Pie">
      
        <a href="../ordenar/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              Ordenar datos
            </div>
          </div>
        </a>
      
      
        <a href="../genesis/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Siguiente
              </span>
              Bioconductor y GENESIS
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta"}, "search": "../assets/javascripts/workers/search.217ffd95.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.926459b3.min.js"></script>
      
    
  </body>
</html>